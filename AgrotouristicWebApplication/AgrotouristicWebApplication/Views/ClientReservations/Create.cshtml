@model Repository.ViewModels.NewReservation

@{
    ViewBag.Title = "Create";
}

<head>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval")



    @if (Model != null)
    {
                if(Model.StartDate != null)
                {
                    <script>
                        $(function () {
                            document.getElementById('termSection').disabled = 'true';
                        });
                    </script>
                    if (Model.AssignedHousesMeals.Keys.ToList().Count >= 1)
                    {
                        <script>
                            $(function () {
                                document.getElementById('housesSection').disabled = 'true';
                                
                            });
                        </script>
                        if(Model.AssignedHousesMeals.First().Value != -1)
                        {
                            <script>
                                $(function () {
                                    document.getElementById('mealsSection').disabled = 'true';
                                });
                            </script>
                            if(Model.AssignedParticipantsHouses.Keys.ToList().Count >=1 && Model.AssignedParticipantsHouses.First().Value[0].Name != null)
                            {
                                <script>
                                    $(function () {
                                        document.getElementById('participantsSection').disabled = 'true';
                                    });
                                </script>
                            }
                            else
                            {
                                <script>
                                    $(function () {
                                        $('#participantsSection').prop('disabled', false);
                                    });
                                </script>
                            }
                        }
                        else
                        {
                            <script>
                                $(function () {
                                    $('#mealsSection').prop('disabled', false);
                                    document.getElementById('participantsSection').disabled = 'true';
                                });
                            </script>
                        }
                    }
                    else
                    {
                        <script>
                            $(function () {
                                $('#housesSection').prop('disabled', false);
                                document.getElementById('mealsSection').disabled = 'true';
                                document.getElementById('participantsSection').disabled = 'true';
                            });
                        </script>
                    }
                }
                else
                {
                    <script>
                        $(function () {
                            $('#termSection').prop('disabled', false);
                            document.getElementById('housesSection').disabled = 'true';
                            document.getElementById('mealsSection').disabled = 'true';
                            document.getElementById('participantsSection').disabled = 'true';
                        });
                    </script>

        }
        <script>
                    $(function () {
                        var stagesCount = '@Model.stagesConfirmation.Where(item=>item.Equals(true)).ToList().Count';
                        if (stagesCount >= 4) {
                            document.getElementById('finalConfirmReservation').style.visibility = 'visible';
                        }
                    });
        </script>
    }

    

</head>


<h2>Dodaj rezerwację</h2>

@using (Html.BeginForm()) 
{
    @Html.AntiForgeryToken()
    
    <div class="form-horizontal">
        <h4>Rezerwacja</h4>
        <hr />
            <input type="button" id="termSection" value="Termin" onclick="location.href='@Url.Action("AddTerm", "ClientReservations")'"/>

            <input type="button" id="housesSection" value="Domki" onclick="location.href='@Url.Action("AddHouses", "ClientReservations")'" disabled="disabled" />

            <input type="button" id="mealsSection" value="Posiłki" onclick="location.href='@Url.Action("AddMeals", "ClientReservations")'" disabled="disabled" />
            
            <input type="button" id="participantsSection" value="Uczestnicy" onclick="location.href='@Url.Action("AddParticipants", "ClientReservations")'" disabled="disabled" />
    </div>

    <div id="content">

    </div>


    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" id="finalConfirmReservation" value="Potwierdź rezerwację" class="btn btn-default" style="visibility:hidden" />
        </div>
    </div>
}

<div>
    @Html.ActionLink("Wróć", "Index")
</div>
